    <header class="theme" id="class_selection" style="padding:20px">
        <form class="form-inline" id="date_picker" method="get" action="/list/">
            <label for="inputDate">選取日期</label>
            <div class="row">
                <div class="form-group">
                    <input type="date" class="form-control" id="inputDate" name='date' pattern="^(\d+)-(\d+)-(\d+)$">
                </div>
                <button type="submit" class="btn btn-default">前往</button>
            </div>
        </form>
    </header>
    <section id="result_students" style="padding-top:20px; padding-bottom:80px; padding-left:15%; padding-right:15%">

        <header class="page-header">
            <h1>{{the_date.Y}}年{{the_date.M}}月{{the_date.D}}日</h1>
        </header>


        <div class="panel panel-default">
            <div class="panel-heading">
                <h2></h2>
                <button type="button" class="btn btn-default" onclick="window.print();">列印</button>
                <button type="button" class="btn btn-default" onclick="move_remainer_to_fail();">歸類未到</button>
            </div>
            <!-- Table -->
            <table class="table table-bordered" id="student_list">
                <thead><tr>
                    <th>姓名</th>
                    <th>學號</th>
                    <th>掃地狀況</th>
                </tr></thead>
                {% for stu in stu_list %}
                    <tr id="stu-{{ stu.student_id }}">
                        <td>{{ stu.name }}</td>
                        <td>{{ stu.student_id }}</td>
                        {% if stu.today_status == "Full" %}
                            <td>已掃完<button type="button" class="btn btn-danger" data-student-id="{{stu.student_id}}" data-type="Cancel">取消</button></td>
                        {% elif stu.today_status == "OneThird" %}
                            <td>已掃完(1/3)<button type="button" class="btn btn-danger" data-student-id="{{ stu.student_id }}" data-type="Cancel">取消</button></td>
                        {% elif stu.today_status == "Fail" %}
                            <td>未到</td>
                        {% elif stu.today_status == "Pending" %}
                            <td><button type="button" class="btn btn-success" data-student-id="{{ stu.student_id }}" data-type="Finish">打卡</button></td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </table>
        </div>


    </section>
    <script>
        $('#student_list').click(function(e){
            var target = $(e.target)
            var stu_id = target.data('student-id');
            var type = target.data('type');
            var data_to_send = {student_id: stu_id,
                                csrfmiddlewaretoken:getCookie('csrftoken'),
                                date: '{{ today }}'};

            if (type == 'Finish'){
                $.post('/list/complete/', data_to_send,function(data){
                    if (data.success){
                        $('#stu-'+stu_id).append( $('<td>已完成\
                            <button type="button" class="btn btn-danger" data-student-id="'+ stu_id+'" data-type="Cancel">取消</button> </td>') );
                        $(target.parent()).remove();
                    }
                });
            }else if (type == 'Cancel'){
                $.post('/list/cancel/',data_to_send,function(data){
                    if (data.success){
                        $('#stu-'+stu_id).append( $('<td>\
                            <button type="button" class="btn btn-success" data-student-id="'+ stu_id+'" data-type="Finish">打卡</button> </td>') );
                        $(target.parent()).remove();
                    }
                });
            }
        });

        function move_remainer_to_fail(){
            var stu_ids = [];
            var candidate = $('button[data-type="Finish"]');
            candidate.each(function(i,v){
                var button = $(v);
                stu_ids.push( button.data('student-id') );
            });
            var data_to_send = {student_ids: JSON.stringify(stu_ids),
                                csrfmiddlewaretoken:getCookie('csrftoken'),
                                date: '{{ today }}'};

            $.post('/list/fail_the_rest/',data_to_send,function(data){
                if( data.success){
                    candidate.after('未到').remove();
                }
            });
        }

        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie != '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) == (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        $('#date_picker').submit(function(e){
            if ( !/^(\d+)-(\d+)-(\d+)$/.exec($('#inputDate').val() ) ){
                alert("時間格式應為 年份-月份-日");

                return false;
            }
        });
    </script>
